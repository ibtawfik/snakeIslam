angular.module("myApp",["ngTouch","ui.bootstrap"]).run(["$translate","realTimeService","randomService","$log",function(a,b,c){"use strict";function d(b){function d(a){var b=a.playersInfo.length;Z=!1,T=[];for(var c=0;b>c;c++)S[c]=s(c),T.push(0);U=[],W="right",V=0}function o(a){d(a),Y=m=a.yourPlayerIndex,$=1===a.playersInfo.length,X=a.matchController,t(),_=(new Date).getTime(),x()}function p(a){var b=a.fromPlayerIndex,c=a.message,d=angular.fromJson(c);for(S[b]=d.a,T[b]=d.s;V<d.f;)t()}function q(a){T=a,Z=!0,y()}function r(){if(!Z){var a=Math.floor(((new Date).getTime()-_)/1e3);if(3>a)return H(),void I(a);var b=z(Y);if(!F(b.x,b.y)||C(b.x,b.y,Y)||D(b.x,b.y,Y))return void E();G(b.x,b.y)?(T[Y]++,v(Y),t()):S[Y].shift(),S[Y].push(b),H()}}function s(a){for(var b=5,c=[],d=0;b>d;d++)c.push({x:d,y:a*Math.floor(g/n.length)});return c}function t(){for(var a=c.randomFromTo(V,0,k),b=c.randomFromTo(V,0,k);u(a,b);)V++,a=c.randomFromTo(V,0,k),b=c.randomFromTo(V,0,k);V++,R={x:a,y:b},x()}function u(a,b){for(var c=0;c<U.length;c++)return U[c].x===a&&U[c].y===b?!0:!1}function v(a){var b=S[a],c=b[0],d=c.x,e=c.y,f=w(a);"left"===f?(d--,d--):"right"===f?(d++,d++):"up"===f?(e--,e--):"down"===f&&(e++,e++),U.push({x:d,y:e})}function w(a){var b=S[a],c=b[0],d=b[1];return c.x>d.x?"left":c.x<d.x?"right":c.y>d.y?"up":"down"}function x(){y();var a=Math.max(50,l-5*Math.floor(V/2));e=setInterval(r,a)}function y(){clearInterval(e)}function z(a){var b=aa.shift();b!==A(W)&&void 0!==b&&(W=b);var c=S[a],d=c[c.length-1].x,e=c[c.length-1].y;return"left"===W?d--:"right"===W?d++:"up"===W?e--:"down"===W&&e++,{x:d,y:e}}function A(a){return"right"===a?"left":"left"===a?"right":"up"===a?"down":"down"===a?"up":void 0}function B(a){aa.length>0&&a[aa.length-1]===a||aa.push(a)}function C(a,b,c){for(var d=S[c],e=0;e<d.length;e++)if(d[e].x===a&&d[e].y===b)return!0;return!1}function D(a,b){for(var c=0;c<U.length;c++)if(U[c].x===a&&U[c].y===b)return!0;return!1}function E(){Z=!0,X.endMatch(T),y()}function F(a,b){return 0>a||a>=j||0>b||b>=k?!1:!0}function G(a,b){return R.x===a&&R.y===b?!0:void 0}function H(){J();for(var a=0;a<S.length;a++)a!=Y&&K(a);K(Y),O(R.x,R.y),L(),P()}function I(b){var c=3-b,d=n[m];ba.fillStyle=d,ba.font="80px sans-serif",ba.fillText(""+c,f/2,g/2),ba.font="20px sans-serif";var e=a("YOUR_SNAKE_COLOR_IS",{color:a(d.toUpperCase())});ba.fillText(e,f/4-30,g/4-30)}function J(){ba.fillStyle="black",ba.fillRect(0,0,f,g)}function K(a){for(var b=S[a],c=0;c<b.length;c++){var d=b[c];N(d.x,d.y,a),O(R.x,R.y)}}function L(){for(var a=0;a<U.length;a++){var b=U[a];M(b.x,b.y)}}function M(a,b){ba.fillStyle="red",ba.fillRect(a*h,b*i,h,i),ba.strokeStyle="white",ba.strokeRect(a*h,b*i,h,i)}function N(a,b,c){var d=n[c];ba.fillStyle=d,ba.fillRect(a*h,b*i,h,i)}function O(a,b){ba.fillStyle="green",ba.fillRect(a*h,b*i,h,i),ba.strokeStyle="white",ba.strokeRect(a*h,b*i,h,i)}function P(){for(var b=0;b<T.length;b++){ba.font="12px sans-serif";var c=n[b];ba.fillStyle=c;var d=a("COLOR_SCORE_IS",{color:a(c.toUpperCase()),score:""+T[b]});ba.fillText(d,5+b*f/S.length,g-5)}}function Q(a){a.preventDefault();var b=a.targetTouches[0];if(b){if(null===ca)return ca=b.pageX,void(da=b.pageY);var c=b.pageX-ca,d=b.pageY-da,e=null,f=Math.abs(c),g=Math.abs(d);(f>=20||g>=20)&&(ca=b.pageX,da=b.pageY,e=f>g?0>c?"left":"right":0>d?"up":"down",B(e))}}var R,S=[],T=[],U=[],V=0,W="right",X=null,Y=null,Z=!1,$=null,_=null,aa=[],ba=b.getContext("2d");document.addEventListener("keydown",function(a){var b=a.which,c=37===b?"left":38===b?"up":39===b?"right":40===b?"down":null;null!==c&&B(c)},!1);var ca=null,da=null;return b.addEventListener("touchstart",function(a){ca=null,da=null,Q(a)},!1),b.addEventListener("touchmove",function(a){Q(a)},!1),b.addEventListener("touchend",function(a){Q(a)},!1),{gotStartMatch:o,gotMessage:p,gotEndMatch:q}}var e,f=300,g=300,h=10,i=10,j=g/i,k=f/h,l=120,m=null,n=["blue","red","brown","purple","pink","yellow","orange","silver"];b.init({createCanvasController:d,canvasWidth:f,canvasHeight:g})}]);
//# sourceMappingURL=index.min.js.map